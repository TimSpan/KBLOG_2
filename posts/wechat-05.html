<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序-05 | KevinBlog</title>
    <meta name="description" content="小程序-05">
    <link rel="stylesheet" href="/KBLOG_2/assets/style.699c32a0.css">
    <link rel="modulepreload" href="/KBLOG_2/assets/Home.aa3234f5.js">
    <link rel="modulepreload" href="/KBLOG_2/assets/app.d3efa65c.js">
    <link rel="modulepreload" href="/KBLOG_2/assets/posts_wechat-05.md.4090255a.lean.js">
    
    <link rel="icon" type="image/png" href="/haimianbaobao.png">
  <meta name="author" content="Kevin">
  <meta property="og:title" content="Home">
  <meta property="og:description" content="Home of Kevin">
  <meta name="twitter:title" content="小程序-05 | KevinBlog">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="no-sidebar theme"><header class="nav-bar" data-v-40587210><div class="sidebar-button" data-v-40587210><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/KBLOG_2/" aria-label="KevinBlog, back to home" data-v-40587210 data-v-016a8bd8><img class="logo" src="/KBLOG_2/haimianbaobao.png" alt="Logo" data-v-016a8bd8> KevinBlog</a><div class="flex-grow" data-v-40587210></div><div class="nav" data-v-40587210><nav class="nav-links" data-v-40587210 data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/KBLOG_2/" data-v-49fe041d>🏡Home <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/KBLOG_2/tags" data-v-49fe041d>🔖Tags <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/KBLOG_2/archives" data-v-49fe041d>📃Archives <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://vue3js.cn/interview/" target="_blank" rel="noopener noreferrer" data-v-49fe041d>面试官问系列 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://www.yuque.com/cuggz/interview/gme0bw" target="_blank" rel="noopener noreferrer" data-v-49fe041d>语雀前端面试题总结 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://www.html5iq.com/index.html" target="_blank" rel="noopener noreferrer" data-v-49fe041d>前端知识库 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--[--><div class="toggleTheme" data-v-f68cd400><div class="light" data-v-f68cd400>🔆</div></div><!--]--><!--]--></header><aside class="sidebar" data-v-17c48e2f><nav class="nav-links nav" data-v-17c48e2f data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/KBLOG_2/" data-v-49fe041d>🏡Home <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/KBLOG_2/tags" data-v-49fe041d>🔖Tags <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/KBLOG_2/archives" data-v-49fe041d>📃Archives <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://vue3js.cn/interview/" target="_blank" rel="noopener noreferrer" data-v-49fe041d>面试官问系列 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://www.yuque.com/cuggz/interview/gme0bw" target="_blank" rel="noopener noreferrer" data-v-49fe041d>语雀前端面试题总结 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://www.html5iq.com/index.html" target="_blank" rel="noopener noreferrer" data-v-49fe041d>前端知识库 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-8fcebc32><div class="container" data-v-8fcebc32><!--[--><!--[--><!----><!--]--><!--[--><h1 class="title" data-v-cda39220></h1><div class="category" data-v-4c27e764><ul data-v-4c27e764><!--[--><li class="header" data-v-4c27e764><a href="#一、使用-npm-包" class="header-h1" data-v-4c27e764>一、使用 npm 包</a><!----></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_1-1、小程序对-npm-的支持与限制" class="header-h2" data-v-4c27e764>1.1、小程序对 npm 的支持与限制</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_1-2、api-promise-化" class="header-h2" data-v-4c27e764>1.2、API Promise 化</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_1-3、实现-api-promise-化" class="header-h2" data-v-4c27e764>1.3、实现 API Promise 化</a></li></ul></li><li class="header" data-v-4c27e764><a href="#二、全局数据共享" class="header-h1" data-v-4c27e764>二、全局数据共享</a><!----></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_2-1、mobx" class="header-h2" data-v-4c27e764>2.1、MobX</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_2-2、创建-mobx-的-store-实例" class="header-h2" data-v-4c27e764>2.2、创建 MobX 的 Store 实例</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_2-3、使用-store-中的成员" class="header-h2" data-v-4c27e764>2.3、使用 Store 中的成员</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_2-4、在组件中使用" class="header-h2" data-v-4c27e764>2.4、在组件中使用</a></li></ul></li><li class="header" data-v-4c27e764><a href="#三、分包" class="header-h1" data-v-4c27e764>三、分包</a><!----></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_3-1、分包概念" class="header-h2" data-v-4c27e764>3.1、分包概念</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_3-2、使用分包" class="header-h2" data-v-4c27e764>3.2、使用分包</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_3-3、独立分包" class="header-h2" data-v-4c27e764>3.3、独立分包</a></li></ul></li><li class="header" data-v-4c27e764><!----><ul data-v-4c27e764><li data-v-4c27e764><a href="#_3-4、分包预下载" class="header-h2" data-v-4c27e764>3.4、分包预下载</a></li></ul></li><li class="header" data-v-4c27e764><a href="#四、自定义-tabbar" class="header-h1" data-v-4c27e764>四、自定义 tabBar</a><!----></li><!--]--></ul></div><!--]--><!--]--><div style="position:relative;" class="content" data-v-8fcebc32><div><h1 id="小程序-05" tabindex="-1">小程序-05 <a class="header-anchor" href="#小程序-05" aria-hidden="true">#</a></h1><h2 id="一、使用-npm-包" tabindex="-1">一、使用 npm 包 <a class="header-anchor" href="#一、使用-npm-包" aria-hidden="true">#</a></h2><h3 id="_1-1、小程序对-npm-的支持与限制" tabindex="-1">1.1、小程序对 npm 的支持与限制 <a class="header-anchor" href="#_1-1、小程序对-npm-的支持与限制" aria-hidden="true">#</a></h3><p>目前，小程序中已经支持使用 npm 安装第三方包，从而来提高小程序的开发效率。</p><p>但是，在小程序中使用 npm 包有如下 3 个限制：</p><p>① 不支持依赖于 Node.js 内置库的包</p><p>② 不支持依赖于浏览器内置对象的包</p><p>③ 不支持依赖于 C++ 插件的包</p><p>总结：虽然 npm 上的包有千千万，但是能供小程序使用的包却“为数不多”。</p><h3 id="_1-2、api-promise-化" tabindex="-1">1.2、API Promise 化 <a class="header-anchor" href="#_1-2、api-promise-化" aria-hidden="true">#</a></h3><p>默认情况下，小程序官方提供的异步 API 都是基于回调函数实现的，例如，网络请求的 API 需要按照 如下的方式调用：</p><div class="language-"><pre><code>wx.request({
  method: &#39;&#39;,
  url: &#39;&#39;,
  data: {},
  success: () =&gt; {}, // 成功的回调
  complate: () =&gt; {}, // 无论成功与否都会执行的回调
  fail: () =&gt; {} // 失败的回调
})
</code></pre></div><p>这种代码的缺点是显而易见的, 容易造成回调地狱的问题，代码的可读性、维护性差！而我们就想将这 种类型的代码使用 API Promise 化进行改造</p><p>API Promise 化，指的是通过额外的配置，将官方提供的、基于回调函数的异步 API ，升级改造为基 于 Promise 的异步 API ，从而提高代码的可读性、维护性，避免回调地狱的问题。</p><h3 id="_1-3、实现-api-promise-化" tabindex="-1">1.3、实现 API Promise 化 <a class="header-anchor" href="#_1-3、实现-api-promise-化" aria-hidden="true">#</a></h3><p>在小程序中，实现 API Promise 化主要依赖于 miniprogram-api-promise 这个第三方的 npm 包。</p><p>它的安装和使用步骤如下:</p><div class="language-bash"><pre><code><span class="token function">npm</span> i --save miniprogram-api-promise

- 下载完成，我们不能直接使用，而是需要再次重新构建npm包
- 建议在构建前先删除原有的miniprogram_npm
- 然后再点击工具，构建npm
</code></pre></div><p>导入并执行代码</p><div class="language-js"><pre><code><span class="token comment">// 在小程序入口文件中（app.js),只需要调用一次 promisifyAll()方法</span>
<span class="token comment">// 即可实现异步API 的Promise化</span>
<span class="token comment">// 按需导入一个方法</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  promisifyAll
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;miniprogram-api-promise&#39;</span>
<span class="token comment">// 声明一个常量，为一个空对象，</span>
<span class="token comment">// 并在wx顶级对象下添加一个属性p也指向该空对象，使所有成员都可以使用该对象</span>
<span class="token keyword">const</span> wxp <span class="token operator">=</span> wx<span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// promisify all wx&#39;s api</span>
<span class="token comment">// 参数1： wx顶级对象</span>
<span class="token comment">// 参数2： wxp指向一个空对象</span>
<span class="token function">promisifyAll</span><span class="token punctuation">(</span>wx<span class="token punctuation">,</span> wxp<span class="token punctuation">)</span>
</code></pre></div><p>解释上述代码:</p><ul><li>promisifyAll : 做的事就是将 wx 拥有的属性方法都copy并改造了一份给了 wxp 这个对象</li><li>然而, wxp 只是当前 js 文件的一个常量，只能在当前文件使用</li><li>因此：我们在 wx 上挂载一个属性 p 让他和 wxp 指向同一个空对象</li><li>在其他页面或者组件就可以通过全局对象 wx 点出 p 来访问到 wxp</li><li>此时 wx.p 发起异步的请求时，得到的是一个 promise 对象</li><li>那么我们就可以使用 async/await 简化Promise语法</li></ul><h2 id="二、全局数据共享" tabindex="-1">二、全局数据共享 <a class="header-anchor" href="#二、全局数据共享" aria-hidden="true">#</a></h2><p>全局数据共享（又叫做：状态管理）是为了解决组件之间数据共享的问题。</p><p>开发中常用的全局数据共享方案有： Vuex 、 Redux 、 MobX 等。</p><p>在小程序中，可使用 mobx-miniprogram 配合 mobx-miniprogram-bindings 实现全局数据共享。其 中：</p><ul><li>mobx-miniprogram 用来创建 Store 实例对象</li><li>mobx-miniprogram-bindings 用来把 Store 中的共享数据或方法，绑定到组件或页面中使用</li></ul><h3 id="_2-1、mobx" tabindex="-1">2.1、MobX <a class="header-anchor" href="#_2-1、mobx" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code><span class="token function">npm</span> init -y
<span class="token function">npm</span> <span class="token function">install</span> --save mobx-miniprogram mobx-miniprogram-bindings
</code></pre></div><p>这里用到了 mobx-miniprogram-bindings 模块，模块说明在这里：</p><p><a href="https://developers.weixin.qq.com/miniprogram/dev/extended/functional/mobx.html" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/extended/functional/mobx.html</a></p><p>npm 命令执行完后，记得在开发者工具的项目中点一下菜单栏中的 <code>工具</code> - <code>构建 npm</code> 。</p><p>在项目根目录下新建store文件夹，并且新建 store.js 文件</p><p><strong>如何使用参考这篇文章</strong>：</p><p><a href="https://developers.weixin.qq.com/community/develop/article/doc/0004686e3c8980b53469f176e51413" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/community/develop/article/doc/0004686e3c8980b53469f176e51413</a></p><h3 id="_2-2、创建-mobx-的-store-实例" tabindex="-1">2.2、创建 MobX 的 Store 实例 <a class="header-anchor" href="#_2-2、创建-mobx-的-store-实例" aria-hidden="true">#</a></h3><p>在项目根目录下新建store文件夹，并且新建 store.js 文件</p><div class="language-js"><pre><code><span class="token comment">// 按需导入第三方包的方法observable, action</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
	observable<span class="token punctuation">,</span>
	action
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;mobx-miniprogram&#39;</span>
<span class="token comment">// 创建 Store实例对象,并将其导出</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token comment">// 数据字段</span>
	numA<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	numB<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token comment">// 计算属性</span>
	<span class="token comment">// 在计算属性的方法前，必须加 get修饰符，代表sum的值是只读的，无法进行修改</span>
	<span class="token comment">// 计算属性sum 依赖于numA和numB的值，因此sum函数的返回值就是最终的值</span>
	<span class="token keyword">get</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numB
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 定义actions方法, 用来修改 store中的数据</span>
	updateNum1<span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+=</span> step
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	updateNum2<span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>numB <span class="token operator">+=</span> step
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-3、使用-store-中的成员" tabindex="-1">2.3、使用 Store 中的成员 <a class="header-anchor" href="#_2-3、使用-store-中的成员" aria-hidden="true">#</a></h3><p>在页面中使用</p><p>页面的 js 文件中</p><div class="language-js"><pre><code><span class="token comment">// 1.首先 导入第三方包，将数据绑定到页面</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  createStoreBindings
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;mobx-miniprogram-bindings&#39;</span>
<span class="token comment">// 2.其次 在页面的js文件的头部区域导入容器的数据</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  store
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../../store/store&#39;</span>
<span class="token comment">// 3. 绑定操作：将仓库的东西绑定到当前的页面中，在页面的js文件的Page方法中</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 上面周期函数--监听页面的加载</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用createStoreBindings方法</span>
    <span class="token comment">// 参数1： 绑定给谁：当前页面this</span>
    <span class="token comment">// 参数2： 对象{ store(容器)， fields(数据)， actions(修改方法)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings <span class="token operator">=</span> <span class="token function">createStoreBindings</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// 映射容器的实例</span>
      store<span class="token punctuation">,</span>
      <span class="token comment">// 映射容器的数据字段</span>
      fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;numA&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;numB&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sum&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// 映射容器修改的方法</span>
      actions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;updateNum1&#39;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 生命周期函数--监听页面的卸载</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用this.storeBindings，得到调用createStoreBindings方法的返回值</span>
    <span class="token comment">//调用destroyStoreBindings 方法，进行清理销毁的工作</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings<span class="token punctuation">.</span><span class="token function">destroyStoreBindings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 页面的js文件中的 tap事件处理函数</span>
  <span class="token function">btnHnadler1</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token comment">// 使用仓库中的方法，并传递数据</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateNum1</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>页面的 wxml 文件中</p><div class="language-html"><pre><code><span class="token comment">&lt;!-- 使用仓库中的数据 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{numA}} + {{numB}} = {{sum}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnHnadler1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>numA+1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2-4、在组件中使用" tabindex="-1">2.4、在组件中使用 <a class="header-anchor" href="#_2-4、在组件中使用" aria-hidden="true">#</a></h3><ol><li>新建组件文件夹以及组件文件 numbers</li><li>全局注册这个组件</li><li>在 message 页面中使用子组件</li></ol><h2 id="三、分包" tabindex="-1">三、分包 <a class="header-anchor" href="#三、分包" aria-hidden="true">#</a></h2><h3 id="_3-1、分包概念" tabindex="-1">3.1、分包概念 <a class="header-anchor" href="#_3-1、分包概念" aria-hidden="true">#</a></h3><p>分包指的是把一个<strong>完整的小程序项目</strong>，按照需求<strong>划分为不同的子包</strong>，在<strong>构建时打包成不同的分包</strong>，<strong>用户在使用时按需进行加载</strong>。</p><p>分包的好处：</p><ul><li>可以优化小程序首次启动的下载时间</li><li>在多团队共同开发时可以更好的解耦协作</li></ul><p><strong>分包前</strong> 项目的构成</p><p>分包前，小程序项目中所有的页面和资源都被打包到了一起，导致整个项目体积过大，影响小程序首次 启动的下载时间。</p><p><strong>分包后</strong> 项目的构成：</p><p>分包后，小程序项目由 <strong>1个主包</strong> + <strong>多个分包</strong>组成：</p><ul><li><strong>主包</strong>：一般只包含项目的启动页面或 TabBar 页面、以及所有分包都需要用到的一些公共资源</li><li><strong>分包</strong>：只包含和当前分包有关的页面和私有资源</li></ul><p>分包的加载规则：</p><ol><li>在小程序启动时，默认会下载主包并启动主包内页面。tabBar 页面需要放到主包中</li><li>当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示。。非 tabBar 页面可以按照功能的不同，划分为不同的分包之后，进行按需下载</li></ol><p>分包的体积限制：</p><p>目前，小程序分包的大小有以下两个限制：</p><ul><li>整个小程序所有分包大小不超过 16M （主包 + 所有分包）</li><li>单个分包/主包大小不能超过 2M</li></ul><h3 id="_3-2、使用分包" tabindex="-1">3.2、使用分包 <a class="header-anchor" href="#_3-2、使用分包" aria-hidden="true">#</a></h3><p>配置方法：</p><p>在 app.json 配置文件中, 新增 subpackages 的节点, 将希望放到分包的页面,写入 subpackages 数组的 元素中.</p><p>打包原则：</p><ol><li>小程序会按 subpackages 的配置进行分包， subpackages 之外的目录将被打包到主包中</li><li>主包也可以有自己的 pages （即最外层的 pages 字段）</li><li>tabBar 页面必须在主包内</li><li>分包之间不能互相嵌套</li></ol><p>引用原则：</p><ol><li>主包无法引用分包内的私有资源</li><li>分包之间不能相互引用私有资源</li><li>分包可以引用主包内的公共资源</li></ol><h3 id="_3-3、独立分包" tabindex="-1">3.3、独立分包 <a class="header-anchor" href="#_3-3、独立分包" aria-hidden="true">#</a></h3><p>独立分包本质上也是分包，只不过它比较特殊，可以独立于主包和其他分包而单独运行。</p><p>独立分包和普通分包的区别:</p><p>最主要的区别：是否依赖于主包才能运行</p><ul><li>普通分包必须依赖于主包才能运行</li><li>独立分包可以在不下载主包的情况下，独立运行</li></ul><p>独立分包的应用场景:</p><p>开发者可以按需，将某些具有一定功能独立性的页面配置到独立分包中。原因如下：</p><ul><li>当小程序从普通的分包页面启动时，</li><li>需要首先下载主包 而独立分包不依赖主包即可运行，可以很大程度上提升分包页面的启动速度</li></ul><blockquote><p>注意：一个小程序中可以有多个独立分包。</p></blockquote><p>和普通分包对比, 独立分包就是在 subpackages 数组的某个元素中, 配置 independent 为true即可</p><ol start="5"><li>引用原则:</li></ol><p>独立分包和普通分包以及主包之间，是相互隔绝的，不能相互引用彼此的资源！例如：</p><ol><li>主包无法引用独立分包内的私有资源</li><li>独立分包之间，不能相互引用私有资源</li><li>独立分包和普通分包之间，不能相互引用私有资源</li><li>特别注意：独立分包中不能引用主包内的公共资源</li></ol><h3 id="_3-4、分包预下载" tabindex="-1">3.4、分包预下载 <a class="header-anchor" href="#_3-4、分包预下载" aria-hidden="true">#</a></h3><p>分包预下载指的是：在进入小程序的某个页面时，由框架自动预下载可能需要的分包，从而提升进入后 续分包页面时的启动速度。</p><p>配置分包的预下载：</p><p>预下载分包的行为，会在进入指定的页面时触发。在 app.json 中，使用 preloadRule 节点定义分包 的预下载规则，示例代码如下：</p><div class="language-json"><pre><code><span class="token property">&quot;preloadRule&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 触发分包预下载的页面路径</span>
    <span class="token property">&quot;page/concact/concact&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// network 表示在指定的网络模式下进行预下载</span>
      <span class="token comment">// 可选值有： all(不限网络)和wifi(仅 wifi 模式下进行预下载)</span>
      <span class="token comment">// 默认值为： wifi</span>
      <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// packages 表示进入页面后， 预下载哪些分包</span>
      <span class="token comment">// 可以通过root 或name 指定预下载哪些分包</span>
      <span class="token property">&quot;packages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pkgA&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>同一个分包中的页面享有共同的预下载大小限额 2M ，例如：</p><p><img src="/KBLOG_2/assets/package.62aee22a.png" alt=""></p><h2 id="四、自定义-tabbar" tabindex="-1">四、自定义 tabBar <a class="header-anchor" href="#四、自定义-tabbar" aria-hidden="true">#</a></h2><p>三大步骤：</p><div class="language-json"><pre><code><span class="token property">&quot;tabBar&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;custom&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2、在项目根目录下创建custom-tab-bar文件夹, 并创建index组件</p><p>新建Component，输入组件名比如 index，自动生成以下文件：</p><div class="language-"><pre><code>custom-tab-bar/index.js
custom-tab-bar/index.json
custom-tab-bar/index.wxml
custom-tab-bar/index.wxss

</code></pre></div><blockquote><p>注意: 文件夹的名称和组件的名称都不能改</p></blockquote><p>3、编写 tabBar 代码</p></div></div><footer class="page-footer" data-v-8fcebc32 data-v-5c96fb00><div class="edit" data-v-5c96fb00><div class="edit-link" data-v-5c96fb00 data-v-55695e90><!----></div></div><div class="updated" data-v-5c96fb00><!----></div></footer><!----><!--[--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></div></main></div><!----><!--]--><footer data-v-c1f40558> Copyright © 2019-2022 | MIT License </footer><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"f5fe0545\",\"archives.md\":\"26efe50a\",\"index.md\":\"9a356bbc\",\"posts_ajax.md\":\"c04be746\",\"posts_git.md\":\"beca9a4a\",\"posts_react.md\":\"041077d9\",\"posts_es6模块化.md\":\"b0b4cbc4\",\"posts_npm使用手册.md\":\"e0d01f9e\",\"posts_npm命令发生的事.md\":\"d314ef4c\",\"posts_vue3快速上手.md\":\"b8f332b6\",\"posts_wechat-01.md\":\"36fa7e59\",\"posts_wechat-02.md\":\"a9bfa25b\",\"posts_wechat-03.md\":\"934603e1\",\"posts_wechat-04.md\":\"75aca085\",\"posts_wechat-05.md\":\"4090255a\",\"posts_前端三件套面试题.md\":\"06e57df2\",\"posts_前端常见面试题总结.md\":\"57bb51e1\",\"posts_前端面试题之浏览器原理篇摘自语雀.md\":\"4c507996\",\"posts_吴雨豪面试题详解.md\":\"a2376c6d\",\"posts_微信小程序封装请求响应拦截器.md\":\"4bb0a376\",\"posts_第二次面试问题.md\":\"23a81ba8\",\"posts_面试题(精简).md\":\"cccbc0d4\",\"posts_面试题之css篇摘自语雀.md\":\"76a2a59b\",\"posts_面试题之javascript篇摘自语雀.md\":\"a6e58da0\",\"posts_面试题之vue篇摘自语雀.md\":\"f381bf8a\",\"posts_面试题之性能优化篇.md\":\"d7f503fb\",\"tags.md\":\"0332bb26\"}")</script>
    <script type="module" async src="/KBLOG_2/assets/app.d3efa65c.js"></script>
    
  </body>
</html>